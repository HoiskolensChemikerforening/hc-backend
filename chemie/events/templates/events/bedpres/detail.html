{% extends "events/bedpres/bedpres_base.html" %}
{% load event_extras %}
{% load thumbnail %}
{% load staticfiles %}

{% block nav_sub_header %}
  Detaljer
{% endblock nav_sub_header %}

{# Breadcrumbs #}
{% block breadcrumbs %}
  <div class="nav-wrapper" style="line-height: 56px; padding-bottom: 10px;">
    <a href="{% url "events:index_bedpres" %}" class="breadcrumb">Bedpres</a>
    <a class="breadcrumb">{{ bedpres.title }}</a>
  </div>
{% endblock %}

{% block permissions %}
  {% include "events/bedpres/permissions_object.html" %}
{% endblock %}

{% block maincontent %}

  <div class="row">
    <div class="col s12 m12 l12"><h1 class="heading">{{ bedpres.title }}</h1></div>
  </div>

  <div class="row">
    <div class="col l7 m12">
      {% thumbnail bedpres.image "1600" crop="center" as im %}
        <img class="responsive-img materialboxed" src="{{ im.url }}">
      {% endthumbnail %}
    </div>

    <div class="col l5 m12 s12">
      <div class="card card-event">
        <div class="card-content">

          <!-- General info -->
          <div class="section">
            <div class="valign-wrapper">
              <i class="material-icons valign left">playlist_add_check</i>
              <h5 class="left-align">Inviterte</h5>
            </div>
            <div>
              <p class="left valign"><b>Klasse:</b></p>
              <p class="right valign">
                {% for grade in bedpres.get_allowed_grades_display %}
                  {{ grade }},
                {% endfor %}</p>
            </div>
          </div>
        <br>

          <div class="divider"></div>

          <div class="section">
            <div class="valign-wrapper">
              <i class="material-icons valign left">location_on</i>
              <h5 class="left-align">Hvor</h5>
            </div>
            <p>{{ bedpres.location }}</p>
          </div>
          <div class="section">
            <div class="valign-wrapper">
              <i class="material-icons valign left">access_time</i>
              <h5 class="left-align">N책r</h5>
            </div>
            <p>{{ bedpres.date|date:"j. F - H:i" }}</p>
          </div>

          <!-- Total and remaining slots bar -->
          <div class="divider"></div>
          <div class="section">
            <div class="valign-wrapper">
              <i class="material-icons valign left">people_outline</i>
              <h5 class="left-align">Plasser</h5>
            </div>
            <div>
              <p class="left valign"><b>P책meldte:</b></p>
              <p class="right valign">{{ bedpres.registered_users|default_if_none:0 }} av {{ bedpres.sluts }}</p>
            </div>
            <br>
            <div class="progress">
              <div class="determinate" style="width: {{ bedpres.percentage_filled }}%"></div>
            </div>
          </div>
        </div>
        <div class="divider"></div>
      </div>

    </div>
  </div>

  <!-- Button for signup page -->
  <a class="waves-effect waves-light btn" href="{{ bedpres.get_absolute_registration_url }}">Til p책melding</a>

  <!-- Desription info -->
  <div class="row">
    <div class="col s12 m12 l12">
      <div class="card">
        <div class="card-content">
          <h5>Beskrivelse:</h5>
          <p class="flow-text"> {{ bedpres.description|safe|linebreaksbr }} </p>
        </div>
      </div>
    </div>
  </div>

  <!-- List of attending users -->
  {% if attendees %}
    <div class="row">
      <div class="col">
        <h2>P책meldte</h2>
        {% include "events/attendees.html" with user_list=attendees %}
      </div>
    </div>
  {% endif %}

  <!-- List of users on waiting list -->
  {% if attendees_waiting %}
    <div class="row">
      <h2>Venteliste</h2>
      {% include "events/waiting_list.html" with user_list=attendees_waiting %}
    </div>
  {% endif %}

{% endblock maincontent %}

{% block footer_js_files %}
  <script src="{% static "events/transpose_table.js" %}"></script>
{% endblock footer_js_files %}